DOCS=	docs/gaussquad.qmd \
	docs/shapes.qmd \
	docs/vecmat.qmd \
	docs/bandmat.qmd \
	docs/mesh.qmd \
	docs/assemble.qmd \
	docs/fem.qmd \
	docs/element.qmd 

OBJS=	obj/gaussquad.o \
	obj/shapes.o \
	obj/vecmat.o \
	obj/bandmat.o \
	obj/mesh.o \
	obj/assemble.o \
	obj/fem.o \
	obj/element.o

TESTS=	exe/test_gauss.x \
	exe/test_shapes.x \
	exe/test_vecmat.x \
	exe/test_bandmat.x \
	exe/test_assemble.x \
	exe/test_fem1d.x

.PHONY: all doc test depend clean

all:

obj/%.o: src/%.c
	gcc -Wall -c $< -o $@

obj/%.o: test/%.c
	gcc -Wall -Isrc -c $< -o $@

exe/%.x: obj/%.o $(OBJS)
	gcc -Wall -o $@ $^

docs/%.qmd: src/%.h src/%.c
	ldoc -highlight c -p quarto -o $@ $^

docs/index.html: docs/index.qmd $(DOCS)
	( cd docs ; quarto render index.qmd --to html )

docs/index.pdf: docs/index.qmd $(DOCS)
	( cd docs ; quarto render index.qmd --to pdf )

doc: docs/index.pdf docs/index.html

test: $(TESTS)
	( for f in exe/test*.x ; do $$f ; done )

depend:
	makedepend -Isrc src/*.c src/*.h test/*.c

clean:
	rm -f src/*~ test/*~ Makefile.bak
	rm -f $(TESTS) $(OBJS) $(DOCS)

# Generated by makedepend
# DO NOT DELETE

src/assemble.o: src/assemble.h src/vecmat.h src/bandmat.h
src/bandmat.o: src/vecmat.h src/bandmat.h
src/element.o: src/shapes.h src/gaussquad.h src/assemble.h src/mesh.h
src/element.o: src/fem.h src/element.h
src/fem.o: src/assemble.h src/element.h src/bandmat.h src/mesh.h src/fem.h
src/gaussquad.o: src/gaussquad.h
src/mesh.o: src/mesh.h
src/shapes.o: src/shapes.h
src/vecmat.o: src/vecmat.h
test/test_assemble.o: src/vecmat.h src/bandmat.h src/assemble.h
test/test_bandmat.o: src/vecmat.h src/bandmat.h
test/test_fem1d.o: src/vecmat.h src/bandmat.h src/mesh.h src/assemble.h
test/test_fem1d.o: src/element.h src/fem.h
test/test_gauss.o: src/gaussquad.h
test/test_shapes.o: src/shapes.h
test/test_vecmat.o: src/vecmat.h
